This is second iteration of the changed code